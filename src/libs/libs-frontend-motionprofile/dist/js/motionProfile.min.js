"use strict";var COSMATT=COSMATT||{};COSMATT.ProfileCalculation=COSMATT.ProfileCalculation||{},COSMATT.ProfileCalculation.AccelDecelSegment=function(){var e,i,o,a,t,n,l,s,r,c,d,m,p,f,u,v,h,x,b,T,y,g,w={},C=function(){i=2/m-1,e=(1-i)*(1-p)/2,o=1-e-i,a=m*e/2,t=m*i,n=m*o/2,l=a/3*e,s=(t+2*a)/2*i,r=(1-n/3)*o,c=l+s+r,l/=c,s/=c,r/=c,d=.5/c},_=function(e){switch(e.permutation){case"TIME_DISTANCE":f=e.time,u=e.distance/f,v=y+2*(u-y)*d,h=v-y,x=f*y,b=e.distance-x;break;case"TIME_VELOCITY":f=e.time,h=e.velocity-y,b=f*h*c,x=f*y}},M=function(){if(e>0){var i=f*e,o=x*e+b*l,t=h*a,n=T,s=n+i,r=g,c=r+o,d=y,m=d+t,p=(m+d)/2,u=(o-p*i)*(-2/Math.pow(i,3)),v=(-3*u*Math.pow(i,2)+t)/(2*i),C=d,_=r,M=0,k=6*u*(s-n)+2*v,A=Math.abs(k),D=Math.sqrt((Math.pow(d,2)+Math.pow(m,2))/2),I=6*u,F={time_initial:n,time_final:s,velocity_initial:d,velocity_final:m,acceleration_initial:M,acceleration_final:k,position_initial:r,position_final:c,motion_equation_third_order_coefficient:u,motion_equation_second_order_coefficient:v,motion_equation_first_order_coefficient:C,motion_equation_zero_order_coefficient:_,rms_acceleration:A,rms_velocity:D,jerk:I};w.ElementsData.push(F),T=s,g=c,y=m}},k=function(){if(i>0){var e=f*i,o=x*i+b*s,a=h*t,n=T,l=n+e,r=g,c=r+o,d=y,m=d+a,p=0,u=(-3*p*Math.pow(e,2)+a)/(2*e),v=d,C=r,_=2*u,M=6*p*(l-n)+2*u,k=Math.abs(M),A=Math.sqrt((Math.pow(d,2)+Math.pow(m,2))/2),D=6*p,I={time_initial:n,time_final:l,velocity_initial:d,velocity_final:m,acceleration_initial:_,acceleration_final:M,position_initial:r,position_final:c,motion_equation_third_order_coefficient:p,motion_equation_second_order_coefficient:u,motion_equation_first_order_coefficient:v,motion_equation_zero_order_coefficient:C,rms_acceleration:k,rms_velocity:A,jerk:D};w.ElementsData.push(I),T=l,g=c,y=m}},A=function(){if(o>0){var e=f*o,i=x*o+b*r,a=h*n,t=T,l=t+e,s=g,c=s+i,d=y,m=d+a,p=(m+d)/2,u=(i-p*e)*(-2/Math.pow(e,3)),v=(-3*u*Math.pow(e,2)+a)/(2*e),C=d,_=s,M=2*v,k=0,A=Math.abs(k),D=Math.sqrt((Math.pow(d,2)+Math.pow(m,2))/2),I=6*u,F={time_initial:t,time_final:l,velocity_initial:d,velocity_final:m,acceleration_initial:M,acceleration_final:k,position_initial:s,position_final:c,motion_equation_third_order_coefficient:u,motion_equation_second_order_coefficient:v,motion_equation_first_order_coefficient:C,motion_equation_zero_order_coefficient:_,rms_acceleration:A,rms_velocity:D,jerk:I};w.ElementsData.push(F),T=l,g=c,y=m}},D=function(){M(),k(),A()},I=function(){var e=w.ElementsData,i=e.length,o=e[i-1].position_final-e[0].position_initial;w.SegmentData.distance=o},F=function(e,i){return w={},w.ElementsData=[],w.SegmentData={},p=e.skewPercentage/100||0,m=1/(1-e.jerkPercentage/200)||1,T=i.time||0,y=i.velocity||0,g=i.position||0,C(),_(e),D(),I(),w};return{calculate:F}}();var COSMATT=COSMATT||{};COSMATT.ProfileCalculation=COSMATT.ProfileCalculation||{},COSMATT.ProfileCalculation.CruiseSegment=function(){var e,i,o,a,t,n={},l=function(e){switch(e.permutation){case"TIME":a=e.time,t=a*i}},s=function(){var l=e,s=l+a,r=o,c=r+t,d=i,m=d,p=0,f=0,u=d,v=r,h=0,x=0,b=Math.abs(x),T=Math.sqrt((Math.pow(d,2)+Math.pow(m,2))/2),y={time_initial:l,time_final:s,velocity_initial:d,velocity_final:m,acceleration_initial:h,acceleration_final:x,position_initial:r,position_final:c,motion_equation_third_order_coefficient:p,motion_equation_second_order_coefficient:f,motion_equation_first_order_coefficient:u,motion_equation_zero_order_coefficient:v,rms_acceleration:b,rms_velocity:T};n.ElementsData.push(y)},r=function(){var e=n.ElementsData,i=e[0].position_final-e[0].position_initial;n.SegmentData.distance=i},c=function(a,t){return n={},n.ElementsData=[],n.SegmentData={},e=t.time||0,i=t.velocity||0,o=t.position||0,l(a),s(),r(),n};return{calculate:c}}();var COSMATT=COSMATT||{};COSMATT.ProfileCalculation=COSMATT.ProfileCalculation||{},COSMATT.ProfileCalculation.ProfileIndexModel=function(){var e,i,o,a,t,n,l,s,r,c,d,m,p,f,u,v,h,x,b=[],T={},y=0,g=0,w=function(e){if(e=parseInt(e),!isNaN(e))switch(e){case 0:y=0,g=0;break;case 1:y=40,g=40;break;case 2:y=100,g=100}},C=function(e){var i,o;i=void 0!=e.velocityJerk?e.velocityJerk:50,o=void 0!=e.velocitySkew?e.velocitySkew:0,l=i/100+1,s=o/100},_=function(){if(u=v=h=x=0,c=(t-i*n)/n,d=c*l,0==d)console.log("cruise velocity zero");else{var w=2*(d*n-(t-i*n))/d;if(m=w*(1+s)/2,p=w*(1-s)/2,f=n-w,m>0){var C={},_={};C.permutation="TIME_VELOCITY",C.velocity=d+i,C.time=m,C.jerkPercentage=y,C.skewPercentage=0,_.position=o,_.velocity=i,_.time=e;var M=COSMATT.ProfileCalculation.AccelDecelSegment.calculate(C,_);u=M.SegmentData.distance,b=b.concat(M.ElementsData),T.accel=M.ElementsData}if(f>0){var k={},A={};k.permutation="TIME",k.velocity=d+i,k.time=f,k.skewPercentage=0,A.position=o+u,A.velocity=i+d,A.time=e+m;var D=COSMATT.ProfileCalculation.CruiseSegment.calculate(k,A);h=D.SegmentData.distance,b=b.concat(D.ElementsData),T.cruise=D.ElementsData}if(p>0){var I={},F={};I.permutation="TIME_VELOCITY",I.velocity=a,I.time=p,I.jerkPercentage=g,I.skewPercentage=0,F.position=o+u+h,F.velocity=d+i,F.time=e+m+f;var P=COSMATT.ProfileCalculation.AccelDecelSegment.calculate(I,F);v=P.SegmentData.distance,b=b.concat(P.ElementsData),T.decel=P.ElementsData}if(r>0){var O={},G={};O.permutation="TIME",O.velocity=a,O.time=r,O.skewPercentage=0,G.position=o+t,G.velocity=a,G.time=e+n;var S=COSMATT.ProfileCalculation.CruiseSegment.calculate(O,G);x=S.SegmentData.distance,b=b.concat(S.ElementsData),T.dwell=S.ElementsData}}},M=function(l,s){if(b=[],T=[],t=l.movedistance||0,n=l.movedtime||0,r=l.dweltime||0,C(l),w(l.smoothness),e=s.time||0,i=s.velocity||0,o=s.position||0,a=i,!(t>0&&n>0))throw{message:"Time and distance needs to be positive values for Profile calculations"};return _(),{elementsData:b,segmentData:T}};return{calculate:M}}();var COSMATT=COSMATT||{};COSMATT.MotionProfile=COSMATT.MotionProfile||{},COSMATT.MotionProfile.configuration={DataFields:{moveDistance:"moveDistance",moveTime:"moveTime",dwellTime:"dwellTime",velocityFormFactor:"indexType",peakVelocity:"peakVelocity",rmsVelocity:"rmsVelocity",peakAccelaration:"peakAcc",rmsAccelaration:"rmsAcc",showAll:!0},Profiles:{profile1:"profile1",profile2:"profile2",profile3:"profile3",showAll:!0},GraphMode:{individualAxis:0,sameAxis:1},Graphs:{position:"pos",velocity:"vel",acceleration:"acc",jerk:"jerk",showAll:!0},GraphHandles:{position:"position",peakVelocity:"peakVelocity",moveTime:"moveTime",dwellTime:"dwellTime",showAll:!0},Smoothness:{automatic:0,standard:1,maximum:2}},function(e){e.fn.motionProfile=function(i){function o(e){e.movedistance&&(x.movedistance=parseFloat(e.movedistance),b.movedistance=parseFloat(e.movedistance),g.find("#moveDistanceInputContainer").find(".comboMoveDistance").data("unitsComboBox").setTextBoxValue(x.movedistance)),e.movedtime&&(x.movedtime=parseFloat(e.movedtime),b.movedtime=parseFloat(e.movedtime),g.find("#moveTimeInputContainer").find(".comboMoveTime").data("unitsComboBox").setTextBoxValue(x.movedtime)),e.dweltime&&(x.dweltime=parseFloat(e.dweltime),b.dweltime=parseFloat(e.dweltime),g.find("#dwellTimeInputContainer").find(".comboDwellTime").data("unitsComboBox").setTextBoxValue(x.dweltime)),e.velocityJerk&&(x.velocityJerk=parseFloat(e.velocityJerk),b.velocityJerk=parseFloat(e.velocityJerk),g.find("#indexTypeInputContainer").find(".comboIndexType").data("unitsComboBox").setTextBoxValue(x.velocityJerk)),se()}function a(e){var i;if(e.movedistance){i=e.movedistance.status?"correct":"incorrect";var o=g.find("#moveDistanceInputContainer").find(".comboMoveDistance");o.addClass(i),o.data("unitsComboBox").update({enable:{textbox:"false",comboBox:"false"}})}if(e.movedtime){i=e.movedtime.status?"correct":"incorrect";var a=g.find("#moveTimeInputContainer").find(".comboMoveTime");a.addClass(i),a.data("unitsComboBox").update({enable:{textbox:"false",comboBox:"false"}})}if(e.dweltime){i=e.dweltime.status?"correct":"incorrect";var n=g.find("#dwellTimeInputContainer").find(".comboDwellTime");n.addClass(i),n.data("unitsComboBox").update({enable:{textbox:"false",comboBox:"false"}})}if(e.velocityJerk){i=e.velocityJerk.status?"correct":"incorrect";var l=g.find("#indexTypeInputContainer").find(".comboIndexType");l.addClass(i),l.data("unitsComboBox").update({enable:{textbox:"false",comboBox:"false"}})}t()}function t(){if(p){var e=p.getData();e[1]&&(e[1].hoverable=!1),p.setupGrid(),p.setData(e),p.draw()}if(f){var i=f.getData();i[1]&&(i[1].hoverable=!1),i[2]&&(i[2].hoverable=!1),i[3]&&(i[3].hoverable=!1),f.setupGrid(),f.setData(i),f.draw()}}var n={activeProfileIndex:1,moveDistance:20,moveTime:10,dwellTime:2,graphMode:COSMATT.MotionProfile.configuration.GraphMode.individualAxis,showGraphs:[COSMATT.MotionProfile.configuration.Graphs.velocity],showGraphDragHandles:COSMATT.MotionProfile.configuration.GraphHandles.showAll,readOnlyInputs:!1,hideInputs:!1,showProfiles:COSMATT.MotionProfile.configuration.Profiles.showAll,smoothness:COSMATT.MotionProfile.configuration.Smoothness.automatic,showCheckAnswerButton:!1,assessmentMode:!1};i.assessmentMode&&(n.moveDistance="",n.moveTime="",n.dwellTime="",n.activeProfileIndex=3);var l=e.extend(n,i),s=this,r=e('<div class="cosmatt-motionProfile unselectable" unselectable="on"></div>');s.append(r),r.append('<div id="profileButtons"><button class="btn btn-default profileButton" id="btn1">Profile 1</button><button class="btn btn-default profileButton" id="btn2">Profile 2</button><button class="btn btn-default profileButton" id="btn3">Profile 3</button></div><div id="graphContainer"></div><div id="inputControls"></div>'),i.assessmentMode&&r.addClass("assessment-mode");var c,d,m,p,f,u,v,h,x={},b={},T={},y={},g=r.find("#inputControls"),w=0,C=0,_=void 0!==l.xmin?parseFloat(l.xmin):15,M=void 0!==l.posYmin?parseFloat(l.posYmin):30,k=void 0!==l.velYmin?parseFloat(l.velYmin):8,A=void 0!==l.accYmin?parseFloat(l.accYmin):2,D=void 0!==l.jerkYmin?parseFloat(l.jerkYmin):3,I={vel:{label:"Velocity",data:[],color:"#f7252a",lines:{show:!0},hoverable:!1,clickable:!1},pos:{label:"Position",data:[],color:"#619beb",series:{lines:{show:!1}},hoverable:!1,clickable:!1},acc:{label:"Acceleration",data:[],color:"#ff8a65",series:{lines:{show:!1}},hoverable:!1,clickable:!1},jerk:{label:"Jerk",data:[],color:"#40cc43",series:{lines:{show:!1}},hoverable:!1,clickable:!1}},F={vel:{data:[],color:"#ef7c7f",lines:{show:!1},points:{show:!0,fillColor:"#ef7c7f"}},pos:{data:[],color:"#619beb",lines:{show:!1},points:{show:!0,fillColor:"#619beb"}},acc:{label:"Acceleration",data:[],color:"#ff8a65"},jerk:{label:"Jerk",data:[],color:"#40cc43"},dwell:{data:[],color:"#ef7c7f",lines:{show:!1},points:{show:!0,fillColor:"#ef7c7f"}},movetime:{data:[],color:"#ef7c7f",lines:{show:!1},points:{show:!0,fillColor:"#ef7c7f"}}},P={series:{lines:{show:!0}},xaxis:{axisLabel:"Time (sec)",position:"bottom"},legend:{show:!0},grid:{hoverable:!0,clickable:!0,borderWidth:{top:0,bottom:1,right:0,left:1}}},O=function(){for(var e in I)I.hasOwnProperty(e)&&(I[e].data=[]);for(var e in F)F.hasOwnProperty(e)&&(F[e].data=[])},G=function(e,i,o){var a=Object.keys(e),t=0;for(var n in a)if(a.hasOwnProperty(n)){var l=1.2*e[a[n]][0][i];l>t&&(t=l)}return o>t&&(t=o),t},S=function(){var e=[];return l.showGraphs.length>0&&(l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.position)>-1?e.push(I.pos,F.pos):e.push([],[]),l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.velocity)>-1?e.push(I.vel,F.vel,F.dwell,F.movetime):e.push([],[],[],[]),l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.acceleration)>-1?e.push(I.acc):e.push([]),l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.jerk)>-1?e.push(I.jerk):e.push([])),e},B=function(e){var i=(Object.keys(e),G(e,"time_final",_));if(p){var o=G(e,"position_final",M);p.getOptions().yaxes[0].max=o,p.getOptions().yaxes[0].min=-1*o,p.getOptions().xaxes[0].max=i,p.setupGrid(),p.setData([I.pos,F.pos]),p.draw()}if(f){var a=G(e,"velocity_final",k);f.getOptions().yaxes[0].max=a,f.getOptions().yaxes[0].min=-1*a,f.getOptions().xaxes[0].max=i,f.setupGrid(),f.setData([I.vel,F.vel,F.dwell,F.movetime]),f.draw()}if(u){var t=G(e,"acceleration_final",A);u.getOptions().yaxes[0].max=t,u.getOptions().yaxes[0].min=-1*t,u.getOptions().xaxes[0].max=i,u.setupGrid(),u.setData([I.acc]),u.draw()}if(h){var n=G(e,"jerk",D);h.getOptions().yaxes[0].max=n,h.getOptions().yaxes[0].min=-1*n,h.getOptions().xaxes[0].max=i,h.setupGrid(),h.setData([I.jerk]),h.draw()}if(v){for(var l,s=v.getOptions().yaxes,r=0;r<s.length;r++){switch(s[r].axisLabel){case"Position (rad)":l=G(e,"position_final",M);break;case"Velocity (rad/sec)":l=G(e,"velocity_final",k);break;case"Acceleration (rad/sec^2)":l=G(e,"acceleration_final",A);break;case"Jerk (rad/sec^3)":l=G(e,"jerk",D)}v.getOptions().yaxes[r].max=l,v.getOptions().yaxes[r].min=-1*l}v.getOptions().xaxes[0].max=i,v.setupGrid(),v.setData(S()),v.draw()}},V=function(i){var o=G(i,"position_final",M),a=G(i,"velocity_final",k),t=G(i,"acceleration_final",A),n=G(i,"time_final",_),s=G(i,"jerk",D),c=r.find("#graphContainer");if(0===c.children().length)if(0===l.graphMode)for(var d=0;d<l.showGraphs.length;d++)c.append('<div id="'+l.showGraphs[d]+'Graph" class="graphArea"></div>');else 1===l.graphMode&&c.append('<div id="aioGraph" class="graphArea"></div>');c.find(".graphArea").addClass("col-xs-"+12/c.children().length+" col-"+12/c.children().length);var m=c.find("#posGraph"),x=c.find("#velGraph"),b=c.find("#accGraph"),T=c.find("#jerkGraph"),y=c.find("#aioGraph");if(m.length>0&&(p=e.plot(m,[I.pos,F.pos],e.extend(!0,{yaxis:{min:-1*o,max:o,position:"left",axisLabel:"Position (rad)"},xaxis:{min:0,max:n}},P)),W(p)),x.length>0&&(f=e.plot(x,[I.vel,F.vel,F.dwell,F.movetime],e.extend(!0,{yaxis:{min:-1*a,max:a,position:"left",axisLabel:"Velocity (rad/sec)"},xaxis:{min:0,max:n}},P)),z(f)),b.length>0&&(u=e.plot(b,[I.acc],e.extend(!0,{yaxis:{min:-1*t,max:t,position:"left",axisLabel:"Acceleration (rad/sec^2)"},xaxis:{min:0,max:n}},P))),T.length>0&&(h=e.plot(T,[I.jerk],e.extend(!0,{yaxis:{min:-1*s,max:s,position:"left",axisLabel:"Jerk (rad/sec^3)"},xaxis:{min:0,max:n}},P)),W(p)),y.length>0){var g={pos:{position:"left",axisLabel:"Position (rad)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3,min:-1*o,max:o},vel:{position:"left",axisLabel:"Velocity (rad/sec)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3,min:-1*a,max:a},acc:{position:"left",axisLabel:"Acceleration (rad/sec^2)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3,min:-1*t,max:t},jerk:{position:"left",axisLabel:"Jerk (rad/sec^3)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3,min:-1*s,max:s}},w=e.extend(!0,{yaxes:function(){for(var e=[],i=0;i<l.showGraphs.length;i++)e[i]=g[l.showGraphs[i]],I[l.showGraphs[i]].yaxis=i+1,F[l.showGraphs[i]].yaxis=i+1;return e}(),xaxis:{min:0,max:n}},P);w.legend={show:!0,backgroundOpacity:0},v=e.plot(y,S(),w),X(v)}l.onGraphPaint&&l.onGraphPaint()},L=function(){var i=r.find("#graphContainer");if(0===i.children().length)if(0===l.graphMode)for(var o=0;o<l.showGraphs.length;o++)i.append('<div id="'+l.showGraphs[o]+'Graph" class="graphArea"></div>');else 1===l.graphMode&&i.append('<div id="aioGraph" class="graphArea"></div>');i.find(".graphArea").addClass("col-xs-"+12/i.children().length+" col-"+12/i.children().length);var a=i.find("#posGraph"),t=i.find("#velGraph"),n=i.find("#accGraph"),s=i.find("#jerkGraph"),c=i.find("#aioGraph");if(a.length>0&&(p=e.plot(a,[I.pos,F.pos],e.extend(!0,{yaxis:{position:"left",axisLabel:"Position (rad)"},xaxis:{min:0}},P))),t.length>0&&(f=e.plot(t,[I.vel,F.vel,F.dwell,F.movetime],e.extend(!0,{yaxis:{position:"left",axisLabel:"Velocity (rad/sec)"},xaxis:{min:0}},P))),n.length>0&&(u=e.plot(n,[I.acc],e.extend(!0,{yaxis:{position:"left",axisLabel:"Acceleration (rad/sec^2)"},xaxis:{min:0}},P))),s.length>0&&(h=e.plot(s,[I.jerk],e.extend(!0,{yaxis:{position:"left",axisLabel:"Jerk (rad/sec^3)"},xaxis:{min:0}},P))),c.length>0){var d={pos:{position:"left",axisLabel:"Position (rad)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3},vel:{position:"left",axisLabel:"Velocity (rad/sec)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3},acc:{position:"left",axisLabel:"Acceleration (rad/sec^2)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3},jerk:{position:"left",axisLabel:"Jerk (rad/sec^3)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3}},m=e.extend(!0,{yaxes:function(){for(var e=[],i=0;i<l.showGraphs.length;i++)e[i]=d[l.showGraphs[i]],I[l.showGraphs[i]].yaxis=i+1,F[l.showGraphs[i]].yaxis=i+1;return e}(),xaxis:{min:0}},P);m.legend={show:!0,backgroundOpacity:0},v=e.plot(c,S(),m)}l.onGraphPaint&&l.onGraphPaint()},N=function(e,i){for(var o=e.time_initial,a=e.time_final,t=e.motion_equation_third_order_coefficient,n=e.motion_equation_second_order_coefficient,l=e.motion_equation_first_order_coefficient,s=e.motion_equation_zero_order_coefficient,r=a-o,c=r/i,d=0;r>d;d+=c)I.jerk.data.push([d+o,6*t]),I.acc.data.push([d+o,6*t*d+2*n]),I.vel.data.push([d+o,3*t*Math.pow(d,2)+2*n*d+l]),I.pos.data.push([d+o,t*Math.pow(d,3)+n*Math.pow(d,2)+l*d+s])},J=function(e){var i,o,a,t;if(e.cruise){var n=(e.cruise[0].time_final+e.cruise[0].time_initial)/2;i=[n,e.cruise[0].velocity_final]}else if(e.accel)for(var s=0,r=0;r<I.vel.data.length;r++)I.vel.data[r][1]>s&&(s=I.vel.data[r][1],i=I.vel.data[r]);e.dwell&&(o=[e.dwell[0].time_final,e.dwell[0].velocity_final]),e.decel?a=[e.decel[0].time_final,e.decel[0].velocity_final]:e.cruise&&(a=[e.cruise[0].time_final,e.cruise[0].velocity_final]);var c=parseFloat(b.movedtime+b.dweltime||0),d=parseFloat(b.movedistance);t=[c,d],l.showGraphDragHandles&&(l.showGraphDragHandles.indexOf("position")>-1&&F.pos.data.push(t),l.showGraphDragHandles.indexOf("peakVelocity")>-1&&F.vel.data.push(i),l.showGraphDragHandles.indexOf("moveTime")>-1&&F.movetime.data.push(a),l.showGraphDragHandles.indexOf("dwellTime")>-1&&F.dwell.data.push(o))},E=function(e){var i,o,a,t,n,l,s,r=e.dwell?e.dwell[0].time_final:0;n=l=s=0;var c,d,m,p;if(c=d=m=p=0,!e.cruise||e.accel||e.decel||(i=e.cruise[0].velocity_final,a=e.cruise[0].acceleration_final,i=parseFloat(i),a=parseFloat(a),o=i,t=a,d=e.cruise[0].rms_acceleration,l=e.cruise[0].time_final),!e.cruise&&e.accel&&e.decel&&(i=e.accel[0].velocity_final,a=e.accel[0].acceleration_final,i=parseFloat(i),a=parseFloat(a),o=i/Math.sqrt(3),t=Math.sqrt(Math.pow(e.accel[0].rms_acceleration,2)+Math.pow(e.decel[0].rms_acceleration,2)),c=e.accel[0].rms_acceleration,m=e.decel[0].rms_acceleration,n=e.accel[0].time_final,s=e.decel[0].time_final,l=n),e.cruise&&e.accel&&e.decel){i=e.cruise[0].velocity_final,a=e.accel[0].acceleration_final,i=parseFloat(i),a=parseFloat(a),n=e.accel[0].time_final,l=e.cruise[0].time_final,s=e.decel[0].time_final;var f=Math.max(n,l,s,r);o=i*Math.sqrt((l-n+(s-l+n)/3)/f),c=e.accel[0].rms_acceleration,d=e.cruise[0].rms_acceleration,m=e.decel[0].rms_acceleration}var f=Math.max(n,l,s,r);t=Math.sqrt((Math.pow(c,2)*n+Math.pow(d,2)*(l-n)+Math.pow(m,2)*(s-l)+Math.pow(p,2)*(r-s))/f),y.peakVel=parseFloat(i),y.peakAcc=parseFloat(a),y.rmsVel=parseFloat(o),y.rmsAcc=parseFloat(t),ee()};s.find("#profileButtons").on("click",".profileButton",function(i){i.preventDefault(),void 0!=e(this).attr("id")&&(l.activeProfileIndex=parseInt(e(this).attr("id").slice(3)),l.smoothness=g.find("#smoothnessInputContainer").find(".smoothnessDropDown").find(".smoothnessDDMenu")[0].selectedIndex,s.find("#profileButtons").find(".profileButton.btn-primary").removeClass("btn-primary").addClass("btn-default"),e(this).addClass("btn-primary").removeClass("btn-default"),l.velocityJerk=void 0,R(),se())});var j=function(){y.peakVel="",y.peakAcc="",y.rmsVel="",y.rmsAcc="",ee()},R=function(){b.movedistance=x.movedistance=isNaN(parseFloat(l.moveDistance))?l.moveDistance:parseFloat(l.moveDistance),b.movedtime=x.movedtime=isNaN(parseFloat(l.moveTime))?l.moveTime:parseFloat(l.moveTime),b.dweltime=x.dweltime=isNaN(parseFloat(l.dwellTime))?l.dwellTime:parseFloat(l.dwellTime),void 0===l.velocityJerk?(K(),b.velocityJerk=x.velocityJerk=isNaN(parseFloat(l.indexType))?l.indexType:parseFloat(l.indexType)):b.velocityJerk=x.velocityJerk=isNaN(parseFloat(l.velocityJerk))?l.velocityJerk:parseFloat(l.velocityJerk),b.smoothness=x.smoothness=isNaN(parseFloat(l.smoothness))?l.smoothness:parseFloat(l.smoothness)},q=function(){var e=!0;return g.find(".input-entries .form-group").removeClass("has-error"),!isNaN(x.movedistance)&&x.movedistance>0||(g.find("#moveDistanceInputContainer").addClass("has-error"),e=!1),!isNaN(x.movedistance)&&x.movedtime>0||(g.find("#moveTimeInputContainer").addClass("has-error"),e=!1),!isNaN(x.dweltime)&&x.dweltime>=0||(g.find("#dwellTimeInputContainer").addClass("has-error"),e=!1),!isNaN(x.velocityJerk)&&x.velocityJerk>=0&&x.velocityJerk<=100||(g.find("#indexTypeInputContainer").addClass("has-error"),e=!1),l.assessmentMode&&g.find(".input-entries .form-group").removeClass("has-error"),e},U=function(){T.time=0,T.position=0,T.velocity=0},Y=function(e){C=0;for(var i=I.vel.data[0][0],o=1;o<I.vel.data.length;o++)C+=(I.vel.data[o][0]-i)*I.vel.data[o][1],i=I.vel.data[o][0];d=-(1/0);var a=JSON.parse(JSON.stringify(b));a.velocityJerk=100,a.velocityJerk=0;for(var t=COSMATT.ProfileCalculation.ProfileIndexModel.calculate(a,T).segmentData,o=0;o<Object.keys(t).length;o++)for(var n=0;n<t[Object.keys(t)[o]].length;n++)d<t[Object.keys(t)[o]][n].velocity_initial&&(d=t[Object.keys(t)[o]][n].velocity_initial);m=2*d,e.dwell&&(w=e.dwell[0].time_initial)},H=function(i,o,a){e('<div id="tooltip">'+a+"</div>").css({top:o+5,left:i+15}).appendTo(r).fadeIn(200)},z=function(e){var i=null,o=null,a=null;s.find("#velGraph").unbind("plothover").bind("plothover",function(t,n,l){if(i=l,l){var s=r.offset();if(a!=l.seriesIndex)switch(l.seriesIndex){case 1:H(l.pageX-s.left,l.pageY-s.top,"Drag to change Velocity Jerk"),a=l.seriesIndex;break;case 2:H(l.pageX-s.left,l.pageY-s.top,"Drag to change Dwell Time"),a=l.seriesIndex;break;case 3:H(l.pageX-s.left,l.pageY-s.top,"Drag to change Move Time"),a=l.seriesIndex}}else r.find("#tooltip").remove(),a=null;if(o&&o.seriesIndex){e.getData();switch(o.seriesIndex){case 1:var c;if(n.y>=m)c=100;else if(n.y<=d)c=0;else{var p=parseFloat(b.movedtime)-C/n.y;c=p*n.y*100/C}x.velocityJerk=parseFloat(Math.ceil(c)),b.velocityJerk=parseFloat(Math.ceil(c));break;case 2:var f;f=n.x<w?0:parseFloat(n.x-w),x.dweltime=parseFloat(f),b.dweltime=parseFloat(f);break;case 3:var u;u=n.x<=0?1:n.x,x.movedtime=parseFloat(u),b.movedtime=parseFloat(u)}se(!0)}}),s.find("#velGraph").unbind("mousedown").bind("mousedown",function(){if(r.find("#tooltip").remove(),i)switch(i.seriesIndex){case 1:i.datapoint[1]>=d&&i.datapoint[1]<=m&&(o=i);break;case 2:i.datapoint[0]>=w&&(o=i);break;case 3:i.datapoint[0]>0&&(o=i)}}),s.find("#velGraph").unbind("mouseup").bind("mouseup",function(){o&&l.onGraphDrag&&l.onGraphDrag(),o=null}),s.find("#velGraph").unbind("mouseleave").bind("mouseleave",function(){s.find("#velGraph").mouseup()})},W=function(e){var i=null,o=null,a=null;s.find("#posGraph").unbind("plothover").bind("plothover",function(t,n,l){if(i=l,l){var s=r.offset();if(a!=l.seriesIndex)switch(l.seriesIndex){case 1:H(l.pageX-s.left,l.pageY-s.top,"Drag to change Move Distance"),a=l.seriesIndex}}else r.find("#tooltip").remove(),a=null;if(o&&o.seriesIndex){e.getData();switch(o.seriesIndex){case 1:var c;c=n.y<=0?1:parseFloat(n.y),x.movedistance=parseFloat(c),b.movedistance=parseFloat(c)}se(!0)}}),s.find("#posGraph").unbind("mousedown").bind("mousedown",function(){if(r.find("#tooltip").remove(),i)switch(i.seriesIndex){case 1:i.datapoint[1]>0&&(o=i)}}),s.find("#posGraph").unbind("mouseup").bind("mouseup",function(){o&&l.onGraphDrag&&l.onGraphDrag(),o=null}),s.find("#posGraph").unbind("mouseleave").bind("mouseleave",function(){s.find("#posGraph").mouseup()})},X=function(e){var i=null,o=null,a=null;s.find("#aioGraph").unbind("plothover").bind("plothover",function(t,n,s){if(i=s,s){var c=r.offset();if(a!=s.seriesIndex)switch(s.seriesIndex){case 1:H(s.pageX-c.left,s.pageY-c.top,"Drag to change Move Distance"),a=s.seriesIndex;break;case 3:H(s.pageX-c.left,s.pageY-c.top,"Drag to change Velocity Jerk"),a=s.seriesIndex;break;case 4:H(s.pageX-c.left,s.pageY-c.top,"Drag to change Dwell Time"),a=s.seriesIndex;break;case 5:H(s.pageX-c.left,s.pageY-c.top,"Drag to change Move Time"),a=s.seriesIndex}}else r.find("#tooltip").remove(),a=null;if(o&&o.seriesIndex){e.getData();switch(o.seriesIndex){case 1:var p;p=n.y<=0?1:parseFloat(n.y),x.movedistance=parseFloat(p),b.movedistance=parseFloat(p);break;case 3:var f,u=l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.position)>-1?n.y2:n.y1;if(u>=m)f=100;else if(d>=u)f=0;else{var v=parseFloat(b.movedtime)-C/u;f=v*u*100/C}x.velocityJerk=parseFloat(Math.ceil(f)),b.velocityJerk=parseFloat(Math.ceil(f));break;case 4:var h;h=n.x<w?0:parseFloat(n.x-w),x.dweltime=parseFloat(h),b.dweltime=parseFloat(h);break;case 5:var T;T=n.x<=0?1:n.x,x.movedtime=parseFloat(T),b.movedtime=parseFloat(T)}se(!0)}}),s.find("#aioGraph").unbind("mousedown").bind("mousedown",function(){if(r.find("#tooltip").remove(),i)switch(i.seriesIndex){case 1:i.datapoint[1]>0&&(o=i);break;case 3:i.datapoint[1]>=d&&i.datapoint[1]<=m&&(o=i);break;case 4:i.datapoint[0]>=w&&(o=i);break;case 5:i.datapoint[0]>0&&(o=i)}}),s.find("#aioGraph").unbind("mouseup").bind("mouseup",function(){o&&l.onGraphDrag&&l.onGraphDrag(),o=null}),s.find("#aioGraph").unbind("mouseleave").bind("mouseleave",function(){s.find("#aioGraph").mouseup()})},Q=function(e){c=COSMATT.ProfileCalculation.ProfileIndexModel.calculate(b,T);var i=c.elementsData,o=i.length;if(o>0){var a=100;O();for(var t=0;o>t;t++)N(i[t],a)}J(c.segmentData),E(c.segmentData),Y(c.segmentData),e?B(c.segmentData):V(c.segmentData)},K=function(){switch(l.activeProfileIndex=parseInt(l.activeProfileIndex),l.activeProfileIndex){case 1:l.indexType=50;break;case 2:l.indexType=100;break;case 3:l.indexType=0}},Z=function(){se()},$=function(){var e=r.find("#inputControls");e.append('<form class="row form-horizontal"><div class="col-6 col-xs-6 input-entries inputs"><div class="row form-group" id="moveDistanceInputContainer"><label for="moveDistance" class="col-4 col-xs-4 control-label">Move Distance</label><div class="col-8 col-xs-8 comboMoveDistance"></div></div><div class="row form-group" id="moveTimeInputContainer"><label for="moveTime" class="col-4 col-xs-4 control-label">Move Time</label><div class="col-8 col-xs-8 comboMoveTime"></div></div><div class="row form-group" id="dwellTimeInputContainer"><label for="dwellTime" class="col-4 col-xs-4 control-label">Dwell Time</label><div class="col-8 col-xs-8 comboDwellTime"></div></div><div class="row form-group" id="indexTypeInputContainer"><label for="indexType" class="col-4 col-xs-4 control-label">Velocity Jerk</label><div class="col-8 col-xs-8 comboIndexType"></div></div><div class="row form-group" id="smoothnessInputContainer"><label for="smoothness" class="col-4 col-xs-4 control-label">Smoothness</label><div class="col-8 col-xs-8 smoothnessDropDown"></div></div></div><div class="col-6 col-xs-6 inputs"><div class="row form-group" id="peakVelocityInputContainer"><label for="peakVelocity" class="col-4 col-xs-4 control-label">Peak Velocity</label><div class="col-8 col-xs-8 comboPeakVelocity"></div></div><div class="row form-group" id="rmsVelocityInputContainer"><label for="rmsVelocity" class="col-4 col-xs-4 control-label">RMS Velocity</label><div class="col-8 col-xs-8 comboRmsVelocity"></div></div><div class="row form-group" id="peakAccInputContainer"><label for="peakAcc" class="col-4 col-xs-4 control-label">Peak Acceleration</label><div class="col-8 col-xs-8 comboPeakAcc"></div></div><div class="row form-group" id="rmsAccInputContainer"><label for="rmsAcc" class="col-4 col-xs-4 control-label">RMS Acceleration</label><div class="col-8 col-xs-8 comboRmsAcc"></div></div></div></form>'),e.find("#moveDistanceInputContainer").find(".comboMoveDistance").unitsComboBox({unitType:"ANGULARDISTANCE",unit:"0",roundOfNumber:"2",value:l.moveDistance,comboBoxWidthRatio:{textBox:"60%",comboBox:"40%"},callBackFn:function(){void 0!=this.type&&"textbox"==this.type&&(x.movedistance=isNaN(parseFloat(this.value))?"":parseFloat(this.value),b.movedistance=""===this.value?"":parseFloat(this.SIValue),Z(),l.assessmentMode&&l.userResponseNotifier&&l.userResponseNotifier({movedistance:x.movedistance}))}}),e.find("#moveTimeInputContainer").find(".comboMoveTime").unitsComboBox({unitType:"TIME",unit:"0",roundOfNumber:"2",value:l.moveTime,comboBoxWidthRatio:{textBox:"60%",comboBox:"40%"},callBackFn:function(){void 0!=this.type&&"textbox"==this.type&&(x.movedtime=isNaN(parseFloat(this.value))?"":parseFloat(this.value),b.movedtime=""===this.value?"":parseFloat(this.SIValue),Z(),l.assessmentMode&&l.userResponseNotifier&&l.userResponseNotifier({movedtime:x.movedtime}))}}),e.find("#dwellTimeInputContainer").find(".comboDwellTime").unitsComboBox({unitType:"TIME",unit:"0",roundOfNumber:"2",value:l.dwellTime,comboBoxWidthRatio:{textBox:"60%",comboBox:"40%"},callBackFn:function(){void 0!=this.type&&"textbox"==this.type&&(x.dweltime=isNaN(parseFloat(this.value))?"":parseFloat(this.value),b.dweltime=""===this.value?"":parseFloat(this.SIValue),Z(),l.assessmentMode&&l.userResponseNotifier&&l.userResponseNotifier({dweltime:x.dweltime}))}}),e.find("#indexTypeInputContainer").find(".comboIndexType").unitsComboBox({unitType:"PERCENTAGE",unit:"0",roundOfNumber:"2",value:l.indexType,comboBoxWidthRatio:{textBox:"60%",comboBox:"40%"},callBackFn:function(){void 0!=this.type&&"textbox"==this.type&&(x.velocityJerk=isNaN(parseFloat(this.value))?"":parseFloat(this.value),b.velocityJerk=""===this.value?"":parseFloat(this.SIValue),Z(),l.assessmentMode&&l.userResponseNotifier&&l.userResponseNotifier({velocityJerk:x.velocityJerk}))}});var i=e.find("#smoothnessInputContainer").find(".smoothnessDropDown");i.append('<select class="form-control smoothnessDDMenu"><option value=automatic>Automatic<option value=standard>Standard<option value=maximum>Maximum</select>'),l.smoothness&&i.find("select option").eq(l.smoothness).attr("selected",!0),i.find("select").on("change",function(e){x.smoothness=e.target.selectedIndex,b.smoothness=e.target.selectedIndex,se(!0)}),e.find("#peakVelocityInputContainer").find(".comboPeakVelocity").unitsComboBox({unitType:"ANGULARVELOCITY",unit:"0",roundOfNumber:"2",value:0,comboBoxWidthRatio:{textBox:"60%",comboBox:"40%"}}),e.find("#rmsVelocityInputContainer").find(".comboRmsVelocity").unitsComboBox({unitType:"ANGULARVELOCITY",unit:"0",roundOfNumber:"2",value:0,comboBoxWidthRatio:{textBox:"60%",comboBox:"40%"}}),e.find("#peakAccInputContainer").find(".comboPeakAcc").unitsComboBox({unitType:"ANGULARACCELERATION",unit:"0",roundOfNumber:"2",value:0,comboBoxWidthRatio:{textBox:"60%",comboBox:"40%"}}),e.find("#rmsAccInputContainer").find(".comboRmsAcc").unitsComboBox({unitType:"ANGULARACCELERATION",unit:"0",roundOfNumber:"2",value:0,comboBoxWidthRatio:{textBox:"60%",comboBox:"40%"}})},ee=function(){var e;e=g.find("#moveDistanceInputContainer").find(".comboMoveDistance").data("unitsComboBox"),b.movedistance?e.setTextBoxValue(e.getValueInSelectedUnit(b.movedistance)):e.setTextBoxValue(b.movedistance),e=g.find("#moveTimeInputContainer").find(".comboMoveTime").data("unitsComboBox"),b.movedtime?e.setTextBoxValue(e.getValueInSelectedUnit(b.movedtime)):e.setTextBoxValue(b.movedtime),e=g.find("#dwellTimeInputContainer").find(".comboDwellTime").data("unitsComboBox"),b.dweltime?e.setTextBoxValue(e.getValueInSelectedUnit(b.dweltime)):e.setTextBoxValue(b.dweltime),e=g.find("#indexTypeInputContainer").find(".comboIndexType").data("unitsComboBox"),b.velocityJerk?e.setTextBoxValue(e.getValueInSelectedUnit(b.velocityJerk)):e.setTextBoxValue(b.velocityJerk),
e=g.find("#peakVelocityInputContainer").find(".comboPeakVelocity").data("unitsComboBox"),y.peakVel?e.setTextBoxValue(e.getValueInSelectedUnit(y.peakVel)):e.setTextBoxValue(y.peakVel),e=g.find("#rmsVelocityInputContainer").find(".comboRmsVelocity").data("unitsComboBox"),y.rmsVel?e.setTextBoxValue(e.getValueInSelectedUnit(y.rmsVel)):e.setTextBoxValue(y.rmsVel),e=g.find("#peakAccInputContainer").find(".comboPeakAcc").data("unitsComboBox"),y.peakAcc?e.setTextBoxValue(e.getValueInSelectedUnit(y.peakAcc)):e.setTextBoxValue(y.peakAcc),e=g.find("#rmsAccInputContainer").find(".comboRmsAcc").data("unitsComboBox"),y.rmsAcc?e.setTextBoxValue(e.getValueInSelectedUnit(y.rmsAcc)):e.setTextBoxValue(y.rmsAcc)},ie=function(e){var i=r.find("#profileButtons");i.find("#btn"+l.activeProfileIndex).addClass("btn-primary").removeClass("btn-default"),l.showProfiles&&oe(l.showProfiles,i),l.showGraphDragHandles&&ae(l.showGraphDragHandles),l.readOnlyInputs&&te(l.readOnlyInputs),l.hideInputs&&ne(l.hideInputs)},oe=function(e,i){if(i.find("button").hide(),"boolean"==typeof e)e===!0?i.show():i.hide();else if(e.length>0)for(var o in e)o=e[o],i.find("#btn"+o.slice(o.length-1)).show()},ae=function(e){"boolean"==typeof e&&(e===!0?l.showGraphDragHandles=[COSMATT.MotionProfile.configuration.GraphHandles.position,COSMATT.MotionProfile.configuration.GraphHandles.peakVelocity,COSMATT.MotionProfile.configuration.GraphHandles.moveTime,COSMATT.MotionProfile.configuration.GraphHandles.dwellTime]:l.showGraphDragHandles=[])},te=function(e){if("boolean"==typeof e&&(e=e===!0?[COSMATT.MotionProfile.configuration.DataFields.moveDistance,COSMATT.MotionProfile.configuration.DataFields.moveTime,COSMATT.MotionProfile.configuration.DataFields.dwellTime,COSMATT.MotionProfile.configuration.DataFields.velocityFormFactor,COSMATT.MotionProfile.configuration.DataFields.peakVelocity,COSMATT.MotionProfile.configuration.DataFields.rmsVelocity,COSMATT.MotionProfile.configuration.DataFields.peakAccelaration,COSMATT.MotionProfile.configuration.DataFields.rmsAccelaration]:[]),e.length>0)for(var i in e)e.hasOwnProperty(i)&&(i=e[i],g.find("#"+i+"InputContainer").find(".combo"+i.charAt(0).toUpperCase()+i.slice(1)).data("unitsComboBox").update({enable:{textbox:"false",comboBox:"true"}}))},ne=function(e){if("boolean"==typeof e&&(e===!0?g.hide():g.show()),e.length>0)for(var i in e)e.hasOwnProperty(i)&&(i=e[i],g.find("#"+i+"InputContainer").hide())},le=function(){var i=e("body"),o='<div id="editConfigBtnContainer"><button class="btn btn-default editConfigBtn pull-right btn-lg" type="button" href="configWindow.html" data-target="#theModal" data-toggle="modal">Edit Configurations</div>';i.append(o)};$(),ie(r),l.showEditConfigButton&&le(),l.showCheckAnswerButton,R(),U();var se=function(e,i){q()?i?setTimeout(function(e){Q()},0):Q(e):(O(),j(),setTimeout(function(e){L()},0))};return se(!1,!0),{ref:this,updateInputs:o,markAnswers:a}}}(jQuery);