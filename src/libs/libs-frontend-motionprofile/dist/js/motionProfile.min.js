"use strict";var COSMATT=COSMATT||{};COSMATT.ProfileCalculation=COSMATT.ProfileCalculation||{},COSMATT.ProfileCalculation.AccelDecelSegment=function(){var e,i,a,o,t,n,l,s,r,c,d,m,p,f,u,v,h,x,b,y,T,w,g={},C=function(){i=2/m-1,e=(1-i)*(1-p)/2,a=1-e-i,o=m*e/2,t=m*i,n=m*a/2,l=o/3*e,s=(t+2*o)/2*i,r=(1-n/3)*a,c=l+s+r,l/=c,s/=c,r/=c,d=.5/c},_=function(e){switch(e.permutation){case"TIME_DISTANCE":f=e.time,u=e.distance/f,v=T+2*(u-T)*d,h=v-T,x=f*T,b=e.distance-x;break;case"TIME_VELOCITY":f=e.time,h=e.velocity-T,b=f*h*c,x=f*T}},k=function(){if(e>0){var i=f*e,a=x*e+b*l,t=h*o,n=y,s=n+i,r=w,c=r+a,d=T,m=d+t,p=(m+d)/2,u=(a-p*i)*(-2/Math.pow(i,3)),v=(-3*u*Math.pow(i,2)+t)/(2*i),C=d,_=r,k=0,M=6*u*(s-n)+2*v,A=Math.abs(M),I=Math.sqrt((Math.pow(d,2)+Math.pow(m,2))/2),D=6*u,F={time_initial:n,time_final:s,velocity_initial:d,velocity_final:m,acceleration_initial:k,acceleration_final:M,position_initial:r,position_final:c,motion_equation_third_order_coefficient:u,motion_equation_second_order_coefficient:v,motion_equation_first_order_coefficient:C,motion_equation_zero_order_coefficient:_,rms_acceleration:A,rms_velocity:I,jerk:D};g.ElementsData.push(F),y=s,w=c,T=m}},M=function(){if(i>0){var e=f*i,a=x*i+b*s,o=h*t,n=y,l=n+e,r=w,c=r+a,d=T,m=d+o,p=0,u=(-3*p*Math.pow(e,2)+o)/(2*e),v=d,C=r,_=2*u,k=6*p*(l-n)+2*u,M=Math.abs(k),A=Math.sqrt((Math.pow(d,2)+Math.pow(m,2))/2),I=6*p,D={time_initial:n,time_final:l,velocity_initial:d,velocity_final:m,acceleration_initial:_,acceleration_final:k,position_initial:r,position_final:c,motion_equation_third_order_coefficient:p,motion_equation_second_order_coefficient:u,motion_equation_first_order_coefficient:v,motion_equation_zero_order_coefficient:C,rms_acceleration:M,rms_velocity:A,jerk:I};g.ElementsData.push(D),y=l,w=c,T=m}},A=function(){if(a>0){var e=f*a,i=x*a+b*r,o=h*n,t=y,l=t+e,s=w,c=s+i,d=T,m=d+o,p=(m+d)/2,u=(i-p*e)*(-2/Math.pow(e,3)),v=(-3*u*Math.pow(e,2)+o)/(2*e),C=d,_=s,k=2*v,M=0,A=Math.abs(M),I=Math.sqrt((Math.pow(d,2)+Math.pow(m,2))/2),D=6*u,F={time_initial:t,time_final:l,velocity_initial:d,velocity_final:m,acceleration_initial:k,acceleration_final:M,position_initial:s,position_final:c,motion_equation_third_order_coefficient:u,motion_equation_second_order_coefficient:v,motion_equation_first_order_coefficient:C,motion_equation_zero_order_coefficient:_,rms_acceleration:A,rms_velocity:I,jerk:D};g.ElementsData.push(F),y=l,w=c,T=m}},I=function(){k(),M(),A()},D=function(){var e=g.ElementsData,i=e.length,a=e[i-1].position_final-e[0].position_initial;g.SegmentData.distance=a},F=function(e,i){return g={},g.ElementsData=[],g.SegmentData={},p=e.skewPercentage/100||0,m=1/(1-e.jerkPercentage/200)||1,y=i.time||0,T=i.velocity||0,w=i.position||0,C(),_(e),I(),D(),g};return{calculate:F}}();var COSMATT=COSMATT||{};COSMATT.ProfileCalculation=COSMATT.ProfileCalculation||{},COSMATT.ProfileCalculation.CruiseSegment=function(){var e,i,a,o,t,n={},l=function(e){switch(e.permutation){case"TIME":o=e.time,t=o*i}},s=function(){var l=e,s=l+o,r=a,c=r+t,d=i,m=d,p=0,f=0,u=d,v=r,h=0,x=0,b=Math.abs(x),y=Math.sqrt((Math.pow(d,2)+Math.pow(m,2))/2),T={time_initial:l,time_final:s,velocity_initial:d,velocity_final:m,acceleration_initial:h,acceleration_final:x,position_initial:r,position_final:c,motion_equation_third_order_coefficient:p,motion_equation_second_order_coefficient:f,motion_equation_first_order_coefficient:u,motion_equation_zero_order_coefficient:v,rms_acceleration:b,rms_velocity:y};n.ElementsData.push(T)},r=function(){var e=n.ElementsData,i=e[0].position_final-e[0].position_initial;n.SegmentData.distance=i},c=function(o,t){return n={},n.ElementsData=[],n.SegmentData={},e=t.time||0,i=t.velocity||0,a=t.position||0,l(o),s(),r(),n};return{calculate:c}}();var COSMATT=COSMATT||{};COSMATT.ProfileCalculation=COSMATT.ProfileCalculation||{},COSMATT.ProfileCalculation.ProfileIndexModel=function(){var e,i,a,o,t,n,l,s,r,c,d,m,p,f,u,v,h,x,b=[],y={},T=0,w=0,g=function(e){if(e=parseInt(e),!isNaN(e))switch(e){case 0:T=0,w=0;break;case 1:T=40,w=40;break;case 2:T=100,w=100}},C=function(e){var i,a;i=void 0!=e.velocityJerk?e.velocityJerk:50,a=void 0!=e.velocitySkew?e.velocitySkew:0,l=i/100+1,s=a/100},_=function(){if(u=v=h=x=0,c=(t-i*n)/n,d=c*l,0==d)console.log("cruise velocity zero");else{var g=2*(d*n-(t-i*n))/d;if(m=g*(1+s)/2,p=g*(1-s)/2,f=n-g,m>0){var C={},_={};C.permutation="TIME_VELOCITY",C.velocity=d+i,C.time=m,C.jerkPercentage=T,C.skewPercentage=0,_.position=a,_.velocity=i,_.time=e;var k=COSMATT.ProfileCalculation.AccelDecelSegment.calculate(C,_);u=k.SegmentData.distance,b=b.concat(k.ElementsData),y.accel=k.ElementsData}if(f>0){var M={},A={};M.permutation="TIME",M.velocity=d+i,M.time=f,M.skewPercentage=0,A.position=a+u,A.velocity=i+d,A.time=e+m;var I=COSMATT.ProfileCalculation.CruiseSegment.calculate(M,A);h=I.SegmentData.distance,b=b.concat(I.ElementsData),y.cruise=I.ElementsData}if(p>0){var D={},F={};D.permutation="TIME_VELOCITY",D.velocity=o,D.time=p,D.jerkPercentage=w,D.skewPercentage=0,F.position=a+u+h,F.velocity=d+i,F.time=e+m+f;var P=COSMATT.ProfileCalculation.AccelDecelSegment.calculate(D,F);v=P.SegmentData.distance,b=b.concat(P.ElementsData),y.decel=P.ElementsData}if(r>0){var O={},B={};O.permutation="TIME",O.velocity=o,O.time=r,O.skewPercentage=0,B.position=a+t,B.velocity=o,B.time=e+n;var G=COSMATT.ProfileCalculation.CruiseSegment.calculate(O,B);x=G.SegmentData.distance,b=b.concat(G.ElementsData),y.dwell=G.ElementsData}}},k=function(l,s){if(b=[],y=[],t=l.movedistance||0,n=l.movedtime||0,r=l.dweltime||0,C(l),g(l.smoothness),e=s.time||0,i=s.velocity||0,a=s.position||0,o=i,!(t>0&&n>0))throw{message:"Time and distance needs to be positive values for Profile calculations"};return _(),{elementsData:b,segmentData:y}};return{calculate:k}}();var COSMATT=COSMATT||{};COSMATT.MotionProfile=COSMATT.MotionProfile||{},COSMATT.MotionProfile.configuration={DataFields:{moveDistance:"moveDistance",moveTime:"moveTime",dwellTime:"dwellTime",velocityFormFactor:"indexType",peakVelocity:"peakVelocity",rmsVelocity:"rmsVelocity",peakAccelaration:"peakAcc",rmsAccelaration:"rmsAcc",showAll:!0},Profiles:{profile1:"profile1",profile2:"profile2",profile3:"profile3",showAll:!0},GraphMode:{individualAxis:0,sameAxis:1},Graphs:{position:"pos",velocity:"vel",acceleration:"acc",jerk:"jerk",showAll:!0},GraphHandles:{position:"position",peakVelocity:"peakVelocity",moveTime:"moveTime",dwellTime:"dwellTime",showAll:!0},Smoothness:{automatic:0,standard:1,maximum:2}},function(e){e.fn.motionProfile=function(i){function a(e){if(e.movedistance){b.movedistance=isNaN(parseFloat(e.movedistance.value))?"":parseFloat(e.movedistance.value);var i=w.find("#moveDistanceInputContainer").find(".comboMoveDistance").data("unitsComboBox");i.setTextBoxValue(b.movedistance),e.movedistance.unit&&(l.moveDistanceUnit=parseInt(e.movedistance.unit),i.setDropBoxItem(l.moveDistanceUnit))}if(e.movedtime){b.movedtime=isNaN(parseFloat(e.movedtime.value))?"":parseFloat(e.movedtime.value);var i=w.find("#moveTimeInputContainer").find(".comboMoveTime").data("unitsComboBox");i.setTextBoxValue(b.movedtime),e.movedtime.unit&&(l.moveTimeUnit=parseInt(e.movedtime.unit),i.setDropBoxItem(l.moveTimeUnit))}if(e.dweltime){b.dweltime=isNaN(parseFloat(e.dweltime.value))?"":parseFloat(e.dweltime.value);var i=w.find("#dwellTimeInputContainer").find(".comboDwellTime").data("unitsComboBox");i.setTextBoxValue(b.dweltime),e.dweltime.unit&&(l.dwellTimeUnit=parseInt(e.dweltime.unit),i.setDropBoxItem(l.dwellTimeUnit))}if(e.velocityJerk){b.velocityJerk=isNaN(parseFloat(e.velocityJerk.value))?"":parseFloat(e.velocityJerk.value);var i=w.find("#indexTypeInputContainer").find(".comboIndexType").data("unitsComboBox");i.setTextBoxValue(b.velocityJerk)}re()}function o(e){var i;if(e.movedistance){i=e.movedistance.status?"correct":"incorrect";var a=w.find("#moveDistanceInputContainer").find(".comboMoveDistance");a.addClass(i),a.data("unitsComboBox").update({enable:{textbox:"false",comboBox:"true"}})}if(e.movedtime){i=e.movedtime.status?"correct":"incorrect";var o=w.find("#moveTimeInputContainer").find(".comboMoveTime");o.addClass(i),o.data("unitsComboBox").update({enable:{textbox:"false",comboBox:"true"}})}if(e.dweltime){i=e.dweltime.status?"correct":"incorrect";var n=w.find("#dwellTimeInputContainer").find(".comboDwellTime");n.addClass(i),n.data("unitsComboBox").update({enable:{textbox:"false",comboBox:"true"}})}if(e.velocityJerk){i=e.velocityJerk.status?"correct":"incorrect";var l=w.find("#indexTypeInputContainer").find(".comboIndexType");l.addClass(i),l.data("unitsComboBox").update({enable:{textbox:"false",comboBox:"true"}})}t()}function t(){if(p){var e=p.getData();e[1]&&(e[1].hoverable=!1),p.setupGrid(),p.setData(e),p.draw()}if(f){var i=f.getData();i[1]&&(i[1].hoverable=!1),i[2]&&(i[2].hoverable=!1),i[3]&&(i[3].hoverable=!1),f.setupGrid(),f.setData(i),f.draw()}}var n={activeProfileIndex:1,moveDistance:20,moveTime:10,dwellTime:2,graphMode:COSMATT.MotionProfile.configuration.GraphMode.individualAxis,showGraphs:[COSMATT.MotionProfile.configuration.Graphs.velocity],showGraphDragHandles:COSMATT.MotionProfile.configuration.GraphHandles.showAll,readOnlyInputs:!1,hideInputs:!1,showProfiles:COSMATT.MotionProfile.configuration.Profiles.showAll,smoothness:COSMATT.MotionProfile.configuration.Smoothness.automatic,showCheckAnswerButton:!1,assessmentMode:!1,moveDistanceUnit:0,moveTimeUnit:0,dwellTimeUnit:0,peakVelocityUnit:0,rmsVelocityUnit:0,peakAccelarationUnit:0,rmsAccelarationUnit:0};i.assessmentMode&&(n.moveDistance="",n.moveTime="",n.dwellTime="",n.activeProfileIndex=3);var l=e.extend(n,i),s=this,r=e('<div class="cosmatt-motionProfile unselectable" unselectable="on"></div>');s.append(r),r.append('<div id="profileButtons"><button class="btn btn-default profileButton" id="btn1">Profile 1</button><button class="btn btn-default profileButton" id="btn2">Profile 2</button><button class="btn btn-default profileButton" id="btn3">Profile 3</button></div><div id="graphContainer"></div><div id="inputControls"></div>'),i.assessmentMode&&r.addClass("assessment-mode");var c,d,m,p,f,u,v,h,x={},b={},y={},T={},w=r.find("#inputControls"),g=0,C=0,_=void 0!==l.xmin?parseFloat(l.xmin):15,k=void 0!==l.posYmin?parseFloat(l.posYmin):30,M=void 0!==l.velYmin?parseFloat(l.velYmin):8,A=void 0!==l.accYmin?parseFloat(l.accYmin):2,I=void 0!==l.jerkYmin?parseFloat(l.jerkYmin):3,D={vel:{label:"Velocity",data:[],color:"#f7252a",lines:{show:!0},hoverable:!1,clickable:!1},pos:{label:"Position",data:[],color:"#619beb",series:{lines:{show:!1}},hoverable:!1,clickable:!1},acc:{label:"Acceleration",data:[],color:"#ff8a65",series:{lines:{show:!1}},hoverable:!1,clickable:!1},jerk:{label:"Jerk",data:[],color:"#40cc43",series:{lines:{show:!1}},hoverable:!1,clickable:!1}},F={vel:{data:[],color:"#ef7c7f",lines:{show:!1},points:{show:!0,fillColor:"#ef7c7f"}},pos:{data:[],color:"#619beb",lines:{show:!1},points:{show:!0,fillColor:"#619beb"}},acc:{label:"Acceleration",data:[],color:"#ff8a65"},jerk:{label:"Jerk",data:[],color:"#40cc43"},dwell:{data:[],color:"#ef7c7f",lines:{show:!1},points:{show:!0,fillColor:"#ef7c7f"}},movetime:{data:[],color:"#ef7c7f",lines:{show:!1},points:{show:!0,fillColor:"#ef7c7f"}}},P={series:{lines:{show:!0}},xaxis:{axisLabel:"Time (sec)",position:"bottom"},legend:{show:!0},grid:{hoverable:!0,clickable:!0,borderWidth:{top:0,bottom:1,right:0,left:1}}},O=function(){for(var e in D)D.hasOwnProperty(e)&&(D[e].data=[]);for(var e in F)F.hasOwnProperty(e)&&(F[e].data=[])},B=function(e,i,a){var o=Object.keys(e),t=0;for(var n in o)if(o.hasOwnProperty(n)){var l=1.2*e[o[n]][0][i];l>t&&(t=l)}return a>t&&(t=a),t},G=function(){var e=[];return l.showGraphs.length>0&&(l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.position)>-1?e.push(D.pos,F.pos):e.push([],[]),l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.velocity)>-1?e.push(D.vel,F.vel,F.dwell,F.movetime):e.push([],[],[],[]),l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.acceleration)>-1?e.push(D.acc):e.push([]),l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.jerk)>-1?e.push(D.jerk):e.push([])),e},V=function(e){var i=(Object.keys(e),B(e,"time_final",_));if(p){var a=B(e,"position_final",k);p.getOptions().yaxes[0].max=a,p.getOptions().yaxes[0].min=-1*a,p.getOptions().xaxes[0].max=i,p.setupGrid(),p.setData([D.pos,F.pos]),p.draw()}if(f){var o=B(e,"velocity_final",M);f.getOptions().yaxes[0].max=o,f.getOptions().yaxes[0].min=-1*o,f.getOptions().xaxes[0].max=i,f.setupGrid(),f.setData([D.vel,F.vel,F.dwell,F.movetime]),f.draw()}if(u){var t=B(e,"acceleration_final",A);u.getOptions().yaxes[0].max=t,u.getOptions().yaxes[0].min=-1*t,u.getOptions().xaxes[0].max=i,u.setupGrid(),u.setData([D.acc]),u.draw()}if(h){var n=B(e,"jerk",I);h.getOptions().yaxes[0].max=n,h.getOptions().yaxes[0].min=-1*n,h.getOptions().xaxes[0].max=i,h.setupGrid(),h.setData([D.jerk]),h.draw()}if(v){for(var l,s=v.getOptions().yaxes,r=0;r<s.length;r++){switch(s[r].axisLabel){case"Position (rad)":l=B(e,"position_final",k);break;case"Velocity (rad/sec)":l=B(e,"velocity_final",M);break;case"Acceleration (rad/sec^2)":l=B(e,"acceleration_final",A);break;case"Jerk (rad/sec^3)":l=B(e,"jerk",I)}v.getOptions().yaxes[r].max=l,v.getOptions().yaxes[r].min=-1*l}v.getOptions().xaxes[0].max=i,v.setupGrid(),v.setData(G()),v.draw()}},S=function(i){var a=B(i,"position_final",k),o=B(i,"velocity_final",M),t=B(i,"acceleration_final",A),n=B(i,"time_final",_),s=B(i,"jerk",I),c=r.find("#graphContainer");if(0===c.children().length)if(0===l.graphMode)for(var d=0;d<l.showGraphs.length;d++)c.append('<div id="'+l.showGraphs[d]+'Graph" class="graphArea"></div>');else 1===l.graphMode&&c.append('<div id="aioGraph" class="graphArea"></div>');c.find(".graphArea").addClass("col-xs-"+12/c.children().length+" col-"+12/c.children().length);var m=c.find("#posGraph"),x=c.find("#velGraph"),b=c.find("#accGraph"),y=c.find("#jerkGraph"),T=c.find("#aioGraph");if(m.length>0&&(p=e.plot(m,[D.pos,F.pos],e.extend(!0,{yaxis:{min:-1*a,max:a,position:"left",axisLabel:"Position (rad)"},xaxis:{min:0,max:n}},P)),W(p)),x.length>0&&(f=e.plot(x,[D.vel,F.vel,F.dwell,F.movetime],e.extend(!0,{yaxis:{min:-1*o,max:o,position:"left",axisLabel:"Velocity (rad/sec)"},xaxis:{min:0,max:n}},P)),z(f)),b.length>0&&(u=e.plot(b,[D.acc],e.extend(!0,{yaxis:{min:-1*t,max:t,position:"left",axisLabel:"Acceleration (rad/sec^2)"},xaxis:{min:0,max:n}},P))),y.length>0&&(h=e.plot(y,[D.jerk],e.extend(!0,{yaxis:{min:-1*s,max:s,position:"left",axisLabel:"Jerk (rad/sec^3)"},xaxis:{min:0,max:n}},P)),W(p)),T.length>0){var w={pos:{position:"left",axisLabel:"Position (rad)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3,min:-1*a,max:a},vel:{position:"left",axisLabel:"Velocity (rad/sec)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3,min:-1*o,max:o},acc:{position:"left",axisLabel:"Acceleration (rad/sec^2)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3,min:-1*t,max:t},jerk:{position:"left",axisLabel:"Jerk (rad/sec^3)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3,min:-1*s,max:s}},g=e.extend(!0,{yaxes:function(){for(var e=[],i=0;i<l.showGraphs.length;i++)e[i]=w[l.showGraphs[i]],D[l.showGraphs[i]].yaxis=i+1,F[l.showGraphs[i]].yaxis=i+1;return e}(),xaxis:{min:0,max:n}},P);g.legend={show:!0,backgroundOpacity:0},v=e.plot(T,G(),g),X(v)}l.onGraphPaint&&l.onGraphPaint()},L=function(){var i=r.find("#graphContainer");if(0===i.children().length)if(0===l.graphMode)for(var a=0;a<l.showGraphs.length;a++)i.append('<div id="'+l.showGraphs[a]+'Graph" class="graphArea"></div>');else 1===l.graphMode&&i.append('<div id="aioGraph" class="graphArea"></div>');i.find(".graphArea").addClass("col-xs-"+12/i.children().length+" col-"+12/i.children().length);var o=i.find("#posGraph"),t=i.find("#velGraph"),n=i.find("#accGraph"),s=i.find("#jerkGraph"),c=i.find("#aioGraph");if(o.length>0&&(p=e.plot(o,[D.pos,F.pos],e.extend(!0,{yaxis:{position:"left",axisLabel:"Position (rad)"},xaxis:{min:0}},P))),t.length>0&&(f=e.plot(t,[D.vel,F.vel,F.dwell,F.movetime],e.extend(!0,{yaxis:{position:"left",axisLabel:"Velocity (rad/sec)"},xaxis:{min:0}},P))),n.length>0&&(u=e.plot(n,[D.acc],e.extend(!0,{yaxis:{position:"left",axisLabel:"Acceleration (rad/sec^2)"},xaxis:{min:0}},P))),s.length>0&&(h=e.plot(s,[D.jerk],e.extend(!0,{yaxis:{position:"left",axisLabel:"Jerk (rad/sec^3)"},xaxis:{min:0}},P))),c.length>0){var d={pos:{position:"left",axisLabel:"Position (rad)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3},vel:{position:"left",axisLabel:"Velocity (rad/sec)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3},acc:{position:"left",axisLabel:"Acceleration (rad/sec^2)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3},jerk:{position:"left",axisLabel:"Jerk (rad/sec^3)",axisLabelUseCanvas:!0,axisLabelFontSizePixels:12,axisLabelFontFamily:"Verdana, Arial",axisLabelPadding:3}},m=e.extend(!0,{yaxes:function(){for(var e=[],i=0;i<l.showGraphs.length;i++)e[i]=d[l.showGraphs[i]],D[l.showGraphs[i]].yaxis=i+1,F[l.showGraphs[i]].yaxis=i+1;return e}(),xaxis:{min:0}},P);m.legend={show:!0,backgroundOpacity:0},v=e.plot(c,G(),m)}l.onGraphPaint&&l.onGraphPaint()},N=function(e,i){for(var a=e.time_initial,o=e.time_final,t=e.motion_equation_third_order_coefficient,n=e.motion_equation_second_order_coefficient,l=e.motion_equation_first_order_coefficient,s=e.motion_equation_zero_order_coefficient,r=o-a,c=r/i,d=0;r>d;d+=c)D.jerk.data.push([d+a,6*t]),D.acc.data.push([d+a,6*t*d+2*n]),D.vel.data.push([d+a,3*t*Math.pow(d,2)+2*n*d+l]),D.pos.data.push([d+a,t*Math.pow(d,3)+n*Math.pow(d,2)+l*d+s])},U=function(e){var i,a,o,t;if(e.cruise){var n=(e.cruise[0].time_final+e.cruise[0].time_initial)/2;i=[n,e.cruise[0].velocity_final]}else if(e.accel)for(var s=0,r=0;r<D.vel.data.length;r++)D.vel.data[r][1]>s&&(s=D.vel.data[r][1],i=D.vel.data[r]);e.dwell&&(a=[e.dwell[0].time_final,e.dwell[0].velocity_final]),e.decel?o=[e.decel[0].time_final,e.decel[0].velocity_final]:e.cruise&&(o=[e.cruise[0].time_final,e.cruise[0].velocity_final]);var c=parseFloat(b.movedtime+b.dweltime||0),d=parseFloat(b.movedistance);t=[c,d],l.showGraphDragHandles&&(l.showGraphDragHandles.indexOf("position")>-1&&F.pos.data.push(t),l.showGraphDragHandles.indexOf("peakVelocity")>-1&&F.vel.data.push(i),l.showGraphDragHandles.indexOf("moveTime")>-1&&F.movetime.data.push(o),l.showGraphDragHandles.indexOf("dwellTime")>-1&&F.dwell.data.push(a))},J=function(e){var i,a,o,t,n,l,s,r=e.dwell?e.dwell[0].time_final:0;n=l=s=0;var c,d,m,p;if(c=d=m=p=0,!e.cruise||e.accel||e.decel||(i=e.cruise[0].velocity_final,o=e.cruise[0].acceleration_final,i=parseFloat(i),o=parseFloat(o),a=i,t=o,d=e.cruise[0].rms_acceleration,l=e.cruise[0].time_final),!e.cruise&&e.accel&&e.decel&&(i=e.accel[0].velocity_final,o=e.accel[0].acceleration_final,i=parseFloat(i),o=parseFloat(o),a=i/Math.sqrt(3),t=Math.sqrt(Math.pow(e.accel[0].rms_acceleration,2)+Math.pow(e.decel[0].rms_acceleration,2)),c=e.accel[0].rms_acceleration,m=e.decel[0].rms_acceleration,n=e.accel[0].time_final,s=e.decel[0].time_final,l=n),e.cruise&&e.accel&&e.decel){i=e.cruise[0].velocity_final,o=e.accel[0].acceleration_final,i=parseFloat(i),o=parseFloat(o),n=e.accel[0].time_final,l=e.cruise[0].time_final,s=e.decel[0].time_final;var f=Math.max(n,l,s,r);a=i*Math.sqrt((l-n+(s-l+n)/3)/f),c=e.accel[0].rms_acceleration,d=e.cruise[0].rms_acceleration,m=e.decel[0].rms_acceleration}var f=Math.max(n,l,s,r);t=Math.sqrt((Math.pow(c,2)*n+Math.pow(d,2)*(l-n)+Math.pow(m,2)*(s-l)+Math.pow(p,2)*(r-s))/f),T.peakVel=parseFloat(i),T.peakAcc=parseFloat(o),T.rmsVel=parseFloat(a),T.rmsAcc=parseFloat(t),ie()};s.find("#profileButtons").on("click",".profileButton",function(i){i.preventDefault(),void 0!=e(this).attr("id")&&(l.activeProfileIndex=parseInt(e(this).attr("id").slice(3)),l.smoothness=w.find("#smoothnessInputContainer").find(".smoothnessDropDown").find(".smoothnessDDMenu")[0].selectedIndex,s.find("#profileButtons").find(".profileButton.btn-primary").removeClass("btn-primary").addClass("btn-default"),e(this).addClass("btn-primary").removeClass("btn-default"),l.velocityJerk=void 0,j(),re())});var E=function(){T.peakVel="",T.peakAcc="",T.rmsVel="",T.rmsAcc="",ie()},j=function(){b.movedistance=x.movedistance=isNaN(parseFloat(l.moveDistance))?l.moveDistance:parseFloat(l.moveDistance),b.movedtime=x.movedtime=isNaN(parseFloat(l.moveTime))?l.moveTime:parseFloat(l.moveTime),b.dweltime=x.dweltime=isNaN(parseFloat(l.dwellTime))?l.dwellTime:parseFloat(l.dwellTime),void 0===l.velocityJerk?(K(),b.velocityJerk=x.velocityJerk=isNaN(parseFloat(l.indexType))?l.indexType:parseFloat(l.indexType)):b.velocityJerk=x.velocityJerk=isNaN(parseFloat(l.velocityJerk))?l.velocityJerk:parseFloat(l.velocityJerk),b.smoothness=x.smoothness=isNaN(parseFloat(l.smoothness))?l.smoothness:parseFloat(l.smoothness)},q=function(){var e=!0;return w.find(".input-entries .form-group").removeClass("has-error"),!isNaN(b.movedistance)&&b.movedistance>0||(w.find("#moveDistanceInputContainer").addClass("has-error"),e=!1),!isNaN(b.movedistance)&&b.movedtime>0||(w.find("#moveTimeInputContainer").addClass("has-error"),e=!1),!isNaN(b.dweltime)&&b.dweltime>=0||(w.find("#dwellTimeInputContainer").addClass("has-error"),e=!1),!isNaN(b.velocityJerk)&&b.velocityJerk>=0&&b.velocityJerk<=100||(w.find("#indexTypeInputContainer").addClass("has-error"),e=!1),l.assessmentMode&&w.find(".input-entries .form-group").removeClass("has-error"),e},R=function(){y.time=0,y.position=0,y.velocity=0},Y=function(e){C=0;for(var i=D.vel.data[0][0],a=1;a<D.vel.data.length;a++)C+=(D.vel.data[a][0]-i)*D.vel.data[a][1],i=D.vel.data[a][0];d=-(1/0);var o=JSON.parse(JSON.stringify(b));o.velocityJerk=100,o.velocityJerk=0;for(var t=COSMATT.ProfileCalculation.ProfileIndexModel.calculate(o,y).segmentData,a=0;a<Object.keys(t).length;a++)for(var n=0;n<t[Object.keys(t)[a]].length;n++)d<t[Object.keys(t)[a]][n].velocity_initial&&(d=t[Object.keys(t)[a]][n].velocity_initial);m=2*d,e.dwell&&(g=e.dwell[0].time_initial)},H=function(i,a,o){e('<div id="tooltip">'+o+"</div>").css({top:a+5,left:i+15}).appendTo(r).fadeIn(200)},z=function(e){var i=null,a=null,o=null;s.find("#velGraph").unbind("plothover").bind("plothover",function(t,n,l){if(i=l,l){var s=r.offset();if(o!=l.seriesIndex)switch(l.seriesIndex){case 1:H(l.pageX-s.left,l.pageY-s.top,"Drag to change Velocity Jerk"),o=l.seriesIndex;break;case 2:H(l.pageX-s.left,l.pageY-s.top,"Drag to change Dwell Time"),o=l.seriesIndex;break;case 3:H(l.pageX-s.left,l.pageY-s.top,"Drag to change Move Time"),o=l.seriesIndex}}else r.find("#tooltip").remove(),o=null;if(a&&a.seriesIndex){e.getData();switch(a.seriesIndex){case 1:var c;if(n.y>=m)c=100;else if(n.y<=d)c=0;else{var p=parseFloat(b.movedtime)-C/n.y;c=p*n.y*100/C}x.velocityJerk=parseFloat(Math.ceil(c)),b.velocityJerk=parseFloat(Math.ceil(c));break;case 2:var f;f=n.x<g?0:parseFloat(n.x-g),x.dweltime=parseFloat(f),b.dweltime=parseFloat(f);break;case 3:var u;u=n.x<=0?1:n.x,x.movedtime=parseFloat(u),b.movedtime=parseFloat(u)}re(!0)}}),s.find("#velGraph").unbind("mousedown").bind("mousedown",function(){if(r.find("#tooltip").remove(),i)switch(i.seriesIndex){case 1:i.datapoint[1]>=d&&i.datapoint[1]<=m&&(a=i);break;case 2:i.datapoint[0]>=g&&(a=i);break;case 3:i.datapoint[0]>0&&(a=i)}}),s.find("#velGraph").unbind("mouseup").bind("mouseup",function(){a&&l.onGraphDrag&&l.onGraphDrag(),a=null}),s.find("#velGraph").unbind("mouseleave").bind("mouseleave",function(){s.find("#velGraph").mouseup()})},W=function(e){var i=null,a=null,o=null;s.find("#posGraph").unbind("plothover").bind("plothover",function(t,n,l){if(i=l,l){var s=r.offset();if(o!=l.seriesIndex)switch(l.seriesIndex){case 1:H(l.pageX-s.left,l.pageY-s.top,"Drag to change Move Distance"),o=l.seriesIndex}}else r.find("#tooltip").remove(),o=null;if(a&&a.seriesIndex){e.getData();switch(a.seriesIndex){case 1:var c;c=n.y<=0?1:parseFloat(n.y),x.movedistance=parseFloat(c),b.movedistance=parseFloat(c)}re(!0)}}),s.find("#posGraph").unbind("mousedown").bind("mousedown",function(){if(r.find("#tooltip").remove(),i)switch(i.seriesIndex){case 1:i.datapoint[1]>0&&(a=i)}}),s.find("#posGraph").unbind("mouseup").bind("mouseup",function(){a&&l.onGraphDrag&&l.onGraphDrag(),a=null}),s.find("#posGraph").unbind("mouseleave").bind("mouseleave",function(){s.find("#posGraph").mouseup()})},X=function(e){var i=null,a=null,o=null;s.find("#aioGraph").unbind("plothover").bind("plothover",function(t,n,s){if(i=s,s){var c=r.offset();if(o!=s.seriesIndex)switch(s.seriesIndex){case 1:H(s.pageX-c.left,s.pageY-c.top,"Drag to change Move Distance"),o=s.seriesIndex;break;case 3:H(s.pageX-c.left,s.pageY-c.top,"Drag to change Velocity Jerk"),o=s.seriesIndex;break;case 4:H(s.pageX-c.left,s.pageY-c.top,"Drag to change Dwell Time"),o=s.seriesIndex;break;case 5:H(s.pageX-c.left,s.pageY-c.top,"Drag to change Move Time"),o=s.seriesIndex}}else r.find("#tooltip").remove(),o=null;if(a&&a.seriesIndex){e.getData();switch(a.seriesIndex){case 1:var p;p=n.y<=0?1:parseFloat(n.y),x.movedistance=parseFloat(p),b.movedistance=parseFloat(p);break;case 3:var f,u=l.showGraphs.indexOf(COSMATT.MotionProfile.configuration.Graphs.position)>-1?n.y2:n.y1;if(u>=m)f=100;else if(d>=u)f=0;else{var v=parseFloat(b.movedtime)-C/u;f=v*u*100/C}x.velocityJerk=parseFloat(Math.ceil(f)),b.velocityJerk=parseFloat(Math.ceil(f));break;case 4:var h;h=n.x<g?0:parseFloat(n.x-g),x.dweltime=parseFloat(h),b.dweltime=parseFloat(h);break;case 5:var y;y=n.x<=0?1:n.x,x.movedtime=parseFloat(y),b.movedtime=parseFloat(y)}re(!0)}}),s.find("#aioGraph").unbind("mousedown").bind("mousedown",function(){if(r.find("#tooltip").remove(),i)switch(i.seriesIndex){case 1:i.datapoint[1]>0&&(a=i);break;case 3:i.datapoint[1]>=d&&i.datapoint[1]<=m&&(a=i);break;case 4:i.datapoint[0]>=g&&(a=i);break;case 5:i.datapoint[0]>0&&(a=i)}}),s.find("#aioGraph").unbind("mouseup").bind("mouseup",function(){a&&l.onGraphDrag&&l.onGraphDrag(),a=null}),s.find("#aioGraph").unbind("mouseleave").bind("mouseleave",function(){s.find("#aioGraph").mouseup()})},Q=function(e){c=COSMATT.ProfileCalculation.ProfileIndexModel.calculate(b,y);var i=c.elementsData,a=i.length;if(a>0){var o=100;O();for(var t=0;a>t;t++)N(i[t],o)}U(c.segmentData),J(c.segmentData),Y(c.segmentData),e?V(c.segmentData):S(c.segmentData)},K=function(){switch(l.activeProfileIndex=parseInt(l.activeProfileIndex),l.activeProfileIndex){case 1:l.indexType=50;break;case 2:l.indexType=100;break;case 3:l.indexType=0}},Z=function(){re()},$=function(){l.assessmentMode&&l.userResponseNotifier&&l.userResponseNotifier({movedistance:{value:b.movedistance,unit:l.moveDistanceUnit},movedtime:{value:b.movedtime,unit:l.moveTimeUnit},dweltime:{value:b.dweltime,unit:l.dwellTimeUnit},velocityJerk:{value:b.velocityJerk}})},ee=function(){var e=r.find("#inputControls");e.append('<form class="row form-horizontal"><div class="col-6 col-xs-6 input-entries inputs"><div class="row form-group" id="moveDistanceInputContainer"><label for="moveDistance" class="col-4 col-xs-4 control-label">Move Distance</label><div class="col-8 col-xs-8 comboMoveDistance"></div></div><div class="row form-group" id="moveTimeInputContainer"><label for="moveTime" class="col-4 col-xs-4 control-label">Move Time</label><div class="col-8 col-xs-8 comboMoveTime"></div></div><div class="row form-group" id="dwellTimeInputContainer"><label for="dwellTime" class="col-4 col-xs-4 control-label">Dwell Time</label><div class="col-8 col-xs-8 comboDwellTime"></div></div><div class="row form-group" id="indexTypeInputContainer"><label for="indexType" class="col-4 col-xs-4 control-label">Velocity Jerk</label><div class="col-8 col-xs-8 comboIndexType"></div></div><div class="row form-group" id="smoothnessInputContainer"><label for="smoothness" class="col-4 col-xs-4 control-label">Smoothness</label><div class="col-8 col-xs-8 smoothnessDropDown"></div></div></div><div class="col-6 col-xs-6 inputs"><div class="row form-group" id="peakVelocityInputContainer"><label for="peakVelocity" class="col-4 col-xs-4 control-label">Peak Velocity</label><div class="col-8 col-xs-8 comboPeakVelocity"></div></div><div class="row form-group" id="rmsVelocityInputContainer"><label for="rmsVelocity" class="col-4 col-xs-4 control-label">RMS Velocity</label><div class="col-8 col-xs-8 comboRmsVelocity"></div></div><div class="row form-group" id="peakAccInputContainer"><label for="peakAcc" class="col-4 col-xs-4 control-label">Peak Acceleration</label><div class="col-8 col-xs-8 comboPeakAcc"></div></div><div class="row form-group" id="rmsAccInputContainer"><label for="rmsAcc" class="col-4 col-xs-4 control-label">RMS Acceleration</label><div class="col-8 col-xs-8 comboRmsAcc"></div></div></div></form>'),e.find("#moveDistanceInputContainer").find(".comboMoveDistance").unitsComboBox({unitType:"ANGULARDISTANCE",unit:l.moveDistanceUnit,roundOfNumber:"2",value:l.moveDistance,comboBoxWidthRatio:{textBox:"55%",comboBox:"45%"},callBackFn:function(){void 0!=this.type&&("dropdown"==this.type?l.moveDistanceUnit=parseInt(this.unit.split("_")[1])-1:"textbox"==this.type&&(x.movedistance=isNaN(parseFloat(this.value))?"":parseFloat(this.value),b.movedistance=""===this.value?"":parseFloat(this.SIValue),Z()),$())}}),e.find("#moveTimeInputContainer").find(".comboMoveTime").unitsComboBox({unitType:"TIME",unit:l.moveTimeUnit,roundOfNumber:"2",value:l.moveTime,comboBoxWidthRatio:{textBox:"55%",comboBox:"45%"},callBackFn:function(){void 0!=this.type&&("dropdown"==this.type?l.moveTimeUnit=parseInt(this.unit.split("_")[1])-1:"textbox"==this.type&&(x.movedtime=isNaN(parseFloat(this.value))?"":parseFloat(this.value),b.movedtime=""===this.value?"":parseFloat(this.SIValue),Z()),$())}}),e.find("#dwellTimeInputContainer").find(".comboDwellTime").unitsComboBox({unitType:"TIME",unit:l.dwellTimeUnit,roundOfNumber:"2",value:l.dwellTime,comboBoxWidthRatio:{textBox:"55%",comboBox:"45%"},callBackFn:function(){void 0!=this.type&&("dropdown"==this.type?l.dwellTimeUnit=parseInt(this.unit.split("_")[1])-1:"textbox"==this.type&&(x.dweltime=isNaN(parseFloat(this.value))?"":parseFloat(this.value),b.dweltime=""===this.value?"":parseFloat(this.SIValue),Z()),$())}}),e.find("#indexTypeInputContainer").find(".comboIndexType").unitsComboBox({unitType:"PERCENTAGE",unit:"0",roundOfNumber:"2",value:l.indexType,comboBoxWidthRatio:{textBox:"55%",comboBox:"45%"},callBackFn:function(){void 0!=this.type&&("textbox"==this.type&&(x.velocityJerk=isNaN(parseFloat(this.value))?"":parseFloat(this.value),b.velocityJerk=""===this.value?"":parseFloat(this.SIValue),Z()),$())}});var i=e.find("#smoothnessInputContainer").find(".smoothnessDropDown");i.append('<select class="form-control smoothnessDDMenu"><option value=automatic>Automatic<option value=standard>Standard<option value=maximum>Maximum</select>'),l.smoothness&&i.find("select option").eq(l.smoothness).attr("selected",!0),i.find("select").on("change",function(e){x.smoothness=e.target.selectedIndex,b.smoothness=e.target.selectedIndex,re(!0)}),e.find("#peakVelocityInputContainer").find(".comboPeakVelocity").unitsComboBox({unitType:"ANGULARVELOCITY",unit:l.peakVelocityUnit,roundOfNumber:"2",value:0,comboBoxWidthRatio:{textBox:"55%",comboBox:"45%"},callBackFn:function(){void 0!=this.type&&"dropdown"==this.type&&(l.peakVelocityUnit=parseInt(this.unit.split("_")[1])-1)}}),e.find("#rmsVelocityInputContainer").find(".comboRmsVelocity").unitsComboBox({unitType:"ANGULARVELOCITY",unit:l.rmsVelocityUnit,roundOfNumber:"2",value:0,comboBoxWidthRatio:{textBox:"55%",comboBox:"45%"},callBackFn:function(){void 0!=this.type&&"dropdown"==this.type&&(l.rmsVelocityUnit=parseInt(this.unit.split("_")[1])-1)}}),e.find("#peakAccInputContainer").find(".comboPeakAcc").unitsComboBox({unitType:"ANGULARACCELERATION",unit:l.peakAccelarationUnit,roundOfNumber:"2",value:0,comboBoxWidthRatio:{
textBox:"55%",comboBox:"45%"},callBackFn:function(){void 0!=this.type&&"dropdown"==this.type&&(l.peakAccelarationUnit=parseInt(this.unit.split("_")[1])-1)}}),e.find("#rmsAccInputContainer").find(".comboRmsAcc").unitsComboBox({unitType:"ANGULARACCELERATION",unit:l.rmsAccelarationUnit,roundOfNumber:"2",value:0,comboBoxWidthRatio:{textBox:"55%",comboBox:"45%"},callBackFn:function(){void 0!=this.type&&"dropdown"==this.type&&(l.rmsAccelarationUnit=parseInt(this.unit.split("_")[1])-1)}})},ie=function(){var e;e=w.find("#moveDistanceInputContainer").find(".comboMoveDistance").data("unitsComboBox"),b.movedistance?e.setTextBoxValue(e.getValueInSelectedUnit(b.movedistance)):e.setTextBoxValue(b.movedistance),e=w.find("#moveTimeInputContainer").find(".comboMoveTime").data("unitsComboBox"),b.movedtime?e.setTextBoxValue(e.getValueInSelectedUnit(b.movedtime)):e.setTextBoxValue(b.movedtime),e=w.find("#dwellTimeInputContainer").find(".comboDwellTime").data("unitsComboBox"),b.dweltime?e.setTextBoxValue(e.getValueInSelectedUnit(b.dweltime)):e.setTextBoxValue(b.dweltime),e=w.find("#indexTypeInputContainer").find(".comboIndexType").data("unitsComboBox"),b.velocityJerk?e.setTextBoxValue(e.getValueInSelectedUnit(b.velocityJerk)):e.setTextBoxValue(b.velocityJerk),e=w.find("#peakVelocityInputContainer").find(".comboPeakVelocity").data("unitsComboBox"),T.peakVel?e.setTextBoxValue(e.getValueInSelectedUnit(T.peakVel)):e.setTextBoxValue(T.peakVel),e=w.find("#rmsVelocityInputContainer").find(".comboRmsVelocity").data("unitsComboBox"),T.rmsVel?e.setTextBoxValue(e.getValueInSelectedUnit(T.rmsVel)):e.setTextBoxValue(T.rmsVel),e=w.find("#peakAccInputContainer").find(".comboPeakAcc").data("unitsComboBox"),T.peakAcc?e.setTextBoxValue(e.getValueInSelectedUnit(T.peakAcc)):e.setTextBoxValue(T.peakAcc),e=w.find("#rmsAccInputContainer").find(".comboRmsAcc").data("unitsComboBox"),T.rmsAcc?e.setTextBoxValue(e.getValueInSelectedUnit(T.rmsAcc)):e.setTextBoxValue(T.rmsAcc)},ae=function(e){var i=r.find("#profileButtons");i.find("#btn"+l.activeProfileIndex).addClass("btn-primary").removeClass("btn-default"),l.showProfiles&&oe(l.showProfiles,i),l.showGraphDragHandles&&te(l.showGraphDragHandles),l.readOnlyInputs&&ne(l.readOnlyInputs),l.hideInputs&&le(l.hideInputs)},oe=function(e,i){if(i.find("button").hide(),"boolean"==typeof e)e===!0?i.show():i.hide();else if(e.length>0)for(var a in e)a=e[a],i.find("#btn"+a.slice(a.length-1)).show()},te=function(e){"boolean"==typeof e&&(e===!0?l.showGraphDragHandles=[COSMATT.MotionProfile.configuration.GraphHandles.position,COSMATT.MotionProfile.configuration.GraphHandles.peakVelocity,COSMATT.MotionProfile.configuration.GraphHandles.moveTime,COSMATT.MotionProfile.configuration.GraphHandles.dwellTime]:l.showGraphDragHandles=[])},ne=function(e){if("boolean"==typeof e&&(e=e===!0?[COSMATT.MotionProfile.configuration.DataFields.moveDistance,COSMATT.MotionProfile.configuration.DataFields.moveTime,COSMATT.MotionProfile.configuration.DataFields.dwellTime,COSMATT.MotionProfile.configuration.DataFields.velocityFormFactor,COSMATT.MotionProfile.configuration.DataFields.peakVelocity,COSMATT.MotionProfile.configuration.DataFields.rmsVelocity,COSMATT.MotionProfile.configuration.DataFields.peakAccelaration,COSMATT.MotionProfile.configuration.DataFields.rmsAccelaration]:[]),e.length>0)for(var i in e)e.hasOwnProperty(i)&&(i=e[i],w.find("#"+i+"InputContainer").find(".combo"+i.charAt(0).toUpperCase()+i.slice(1)).data("unitsComboBox").update({enable:{textbox:"false",comboBox:"true"}}))},le=function(e){if("boolean"==typeof e&&(e===!0?w.hide():w.show()),e.length>0)for(var i in e)e.hasOwnProperty(i)&&(i=e[i],w.find("#"+i+"InputContainer").hide())},se=function(){var i=e("body"),a='<div id="editConfigBtnContainer"><button class="btn btn-default editConfigBtn pull-right btn-lg" type="button" href="configWindow.html" data-target="#theModal" data-toggle="modal">Edit Configurations</div>';i.append(a)};ee(),ae(r),l.showEditConfigButton&&se(),l.showCheckAnswerButton,j(),R();var re=function(e,i){q()?i?setTimeout(function(e){Q()},0):Q(e):(O(),E(),setTimeout(function(e){L()},0))};return re(!1,!0),{ref:this,updateInputs:a,markAnswers:o}}}(jQuery);